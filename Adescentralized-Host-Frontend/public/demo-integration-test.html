<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Integra√ß√£o - Stellar Ads SDK</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0 0 10px 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .header p {
            margin: 0;
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .content {
            padding: 40px;
        }
        
        .test-section {
            margin-bottom: 40px;
            padding: 25px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            background: #f8f9fa;
        }
        
        .test-section h3 {
            margin: 0 0 15px 0;
            color: #2d3748;
            font-size: 1.3em;
        }
        
        .test-section p {
            margin: 0 0 20px 0;
            color: #4a5568;
            line-height: 1.6;
        }
        
        .api-status {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            margin-bottom: 15px;
        }
        
        .api-status.checking {
            background: #fed7d7;
            color: #c53030;
        }
        
        .api-status.online {
            background: #c6f6d5;
            color: #22543d;
        }
        
        .api-status.offline {
            background: #fed7d7;
            color: #c53030;
        }
        
        .controls {
            margin: 20px 0;
        }
        
        .btn {
            display: inline-block;
            padding: 10px 20px;
            margin: 5px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            transition: opacity 0.2s;
        }
        
        .btn:hover {
            opacity: 0.9;
        }
        
        .btn.secondary {
            background: #e2e8f0;
            color: #2d3748;
        }
        
        .log-output {
            background: #1a202c;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.85em;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 15px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e1e5e9;
            text-align: center;
        }
        
        .stat-value {
            font-size: 2em;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #6c757d;
            font-size: 0.9em;
        }
        
        /* Estilos para diferentes tamanhos de an√∫ncios */
        .ad-row {
            margin: 30px 0;
            padding: 20px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e1e5e9;
        }
        
        .ad-row h4 {
            margin: 0 0 15px 0;
            color: #2d3748;
        }
        
        .footer {
            background: #2d3748;
            color: white;
            padding: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ Teste de Integra√ß√£o</h1>
            <p>SDK Stellar Ads - Demonstra√ß√£o Completa</p>
        </div>
        
        <div class="content">
            <!-- Status da API -->
            <div class="test-section">
                <h3>üì° Status da API de An√∫ncios</h3>
                <div id="api-status" class="api-status checking">Verificando conex√£o...</div>
                <p>Status da conectividade com a API de an√∫ncios na porta 3000.</p>
                <div class="controls">
                    <button class="btn" onclick="checkApiStatus()">Verificar Status</button>
                    <button class="btn secondary" onclick="clearLogs()">Limpar Logs</button>
                </div>
                <div id="api-logs" class="log-output"></div>
            </div>
            
            <!-- Configura√ß√£o do SDK -->
            <div class="test-section">
                <h3>‚öôÔ∏è Configura√ß√£o do SDK</h3>
                <p>Configura√ß√µes personalizadas aplicadas ao SDK:</p>
                <div class="controls">
                    <button class="btn" onclick="toggleDebugMode()">Alternar Debug</button>
                    <button class="btn" onclick="refreshAds()">Atualizar An√∫ncios</button>
                    <button class="btn secondary" onclick="showSDKInfo()">Info do SDK</button>
                </div>
            </div>
            
            <!-- Estat√≠sticas de Teste -->
            <div class="test-section">
                <h3>üìä Estat√≠sticas de Teste</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="impressions-count">0</div>
                        <div class="stat-label">Impress√µes</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="clicks-count">0</div>
                        <div class="stat-label">Cliques</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="errors-count">0</div>
                        <div class="stat-label">Erros</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="api-calls">0</div>
                        <div class="stat-label">Chamadas API</div>
                    </div>
                </div>
            </div>
            
            <!-- Containers de An√∫ncios -->
            <div class="test-section">
                <h3>üì¢ Containers de An√∫ncios</h3>
                <p>Diferentes tamanhos e configura√ß√µes de an√∫ncios:</p>
                
                <!-- An√∫ncio Pequeno -->
                <div class="ad-row">
                    <h4>An√∫ncio Pequeno (300x250)</h4>
                    <div id="stellar-ad-small" 
                         data-site-id="test-site-001" 
                         data-size="small" 
                         data-tags="tecnologia,programacao">
                    </div>
                </div>
                
                <!-- An√∫ncio M√©dio -->
                <div class="ad-row">
                    <h4>An√∫ncio M√©dio (728x90) - Banner</h4>
                    <div id="stellar-ad-medium" 
                         data-site-id="test-site-001" 
                         data-size="medium" 
                         data-tags="neg√≥cios,marketing">
                    </div>
                </div>
                
                <!-- An√∫ncio Grande -->
                <div class="ad-row">
                    <h4>An√∫ncio Grande (970x250) - Leaderboard</h4>
                    <div id="stellar-ad-large" 
                         data-site-id="test-site-001" 
                         data-size="large" 
                         data-tags="inovacao,blockchain">
                    </div>
                </div>
                
                <!-- An√∫ncio Responsivo -->
                <div class="ad-row">
                    <h4>An√∫ncio Responsivo</h4>
                    <div id="stellar-ad-responsive" 
                         data-site-id="test-site-001" 
                         data-size="responsive" 
                         data-tags="educacao,desenvolvimento">
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>Stellar Ads SDK v2.0.0 - Sistema de An√∫ncios Descentralizados</p>
        </div>
    </div>

    <!-- Configura√ß√£o do SDK -->
    <script>
        // Configura√ß√£o personalizada para teste
        window.StellarAdsConfig = {
            debug: true,
            autoRefresh: false,
            refreshInterval: 2
        };
        
        // Estat√≠sticas de teste
        let testStats = {
            impressions: 0,
            clicks: 0,
            errors: 0,
            apiCalls: 0
        };
        
        // Fun√ß√£o para log
        function addLog(message, type = 'info') {
            const logs = document.getElementById('api-logs');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.innerHTML = `<span style="color: #718096">[${timestamp}]</span> ${message}`;
            logs.appendChild(logEntry);
            logs.scrollTop = logs.scrollHeight;
        }
        
        // Verificar status da API
        async function checkApiStatus() {
            addLog('üîç Verificando status da API...', 'info');
            const statusEl = document.getElementById('api-status');
            statusEl.className = 'api-status checking';
            statusEl.textContent = 'Verificando...';
            
            try {
                testStats.apiCalls++;
                updateStats();
                
                const response = await fetch('http://localhost:3000/api/ad?siteId=test-site-001');
                
                if (response.ok) {
                    const data = await response.json();
                    statusEl.className = 'api-status online';
                    statusEl.textContent = '‚úÖ API Online';
                    addLog(`‚úÖ API respondendo: ${JSON.stringify(data)}`, 'success');
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                statusEl.className = 'api-status offline';
                statusEl.textContent = '‚ùå API Offline';
                addLog(`‚ùå Erro na API: ${error.message}`, 'error');
                testStats.errors++;
                updateStats();
            }
        }
        
        // Alternar modo debug
        function toggleDebugMode() {
            window.StellarAdsConfig.debug = !window.StellarAdsConfig.debug;
            addLog(`üîß Debug mode: ${window.StellarAdsConfig.debug ? 'ON' : 'OFF'}`);
            
            if (window.StellarAdsSDK.instance) {
                window.StellarAdsSDK.instance.debug = window.StellarAdsConfig.debug;
            }
        }
        
        // Atualizar an√∫ncios
        function refreshAds() {
            if (window.StellarAdsSDK && window.StellarAdsSDK.refresh) {
                addLog('üîÑ Atualizando todos os an√∫ncios...');
                window.StellarAdsSDK.refresh();
            } else {
                addLog('‚ùå SDK n√£o inicializado', 'error');
            }
        }
        
        // Mostrar informa√ß√µes do SDK
        function showSDKInfo() {
            if (window.StellarAdsSDK) {
                const info = {
                    version: window.StellarAdsSDK.version,
                    containers: window.StellarAdsSDK.instance ? window.StellarAdsSDK.instance.containers.size : 0,
                    debug: window.StellarAdsConfig.debug
                };
                addLog(`‚ÑπÔ∏è  SDK Info: ${JSON.stringify(info)}`);
            }
        }
        
        // Limpar logs
        function clearLogs() {
            document.getElementById('api-logs').innerHTML = '';
            addLog('üßΩ Logs limpos');
        }
        
        // Atualizar estat√≠sticas
        function updateStats() {
            document.getElementById('impressions-count').textContent = testStats.impressions;
            document.getElementById('clicks-count').textContent = testStats.clicks;
            document.getElementById('errors-count').textContent = testStats.errors;
            document.getElementById('api-calls').textContent = testStats.apiCalls;
        }
        
        // Interceptar eventos do SDK para estat√≠sticas
        document.addEventListener('DOMContentLoaded', function() {
            // Verificar status inicial
            setTimeout(checkApiStatus, 1000);
            
            // Monitorar clicks nos an√∫ncios
            document.addEventListener('click', function(e) {
                if (e.target.closest('.stellar-ad')) {
                    testStats.clicks++;
                    updateStats();
                    addLog('üëÜ Clique registrado em an√∫ncio');
                }
            });
            
            // Monitorar carregamento de an√∫ncios (impress√µes)
            const observer = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    if (mutation.type === 'childList') {
                        mutation.addedNodes.forEach(function(node) {
                            if (node.nodeType === 1 && node.querySelector && node.querySelector('.stellar-ad')) {
                                testStats.impressions++;
                                updateStats();
                                addLog('üëÅÔ∏è  Impress√£o registrada');
                            }
                        });
                    }
                });
            });
            
            // Observar containers de an√∫ncios
            document.querySelectorAll('[data-site-id]').forEach(container => {
                observer.observe(container, { childList: true, subtree: true });
            });
            
            addLog('üöÄ Sistema de monitoramento inicializado');
        });
    </script>
    
    <!-- Carregar SDK -->
    <script src="./sdk.js"></script>
</body>
</html>
