<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo Avan√ßado - Stellar Ads SDK</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f8f9fa;
        }
        .container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        h1 {
            color: #2d3748;
            margin-bottom: 10px;
        }
        .subtitle {
            color: #4a5568;
            font-size: 18px;
            margin-bottom: 30px;
        }
        .demo-section {
            margin: 40px 0;
            padding: 20px;
            border: 2px dashed #e2e8f0;
            border-radius: 8px;
        }
        .demo-title {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 15px;
        }
        .code-block {
            background: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 15px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 14px;
            margin: 15px 0;
            overflow-x: auto;
        }
        .controls {
            margin: 20px 0;
            padding: 20px;
            background: #f7fafc;
            border-radius: 8px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: opacity 0.2s;
        }
        .btn:hover {
            opacity: 0.9;
        }
        .btn.success {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
        }
        .btn.danger {
            background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
        }
        .info {
            background: #e6fffa;
            border: 1px solid #81e6d9;
            border-radius: 6px;
            padding: 15px;
            color: #234e52;
            margin: 15px 0;
        }
        .warning {
            background: #fffbeb;
            border: 1px solid #f6cc56;
            border-radius: 6px;
            padding: 15px;
            color: #744210;
            margin: 15px 0;
        }
        .error {
            background: #fed7d7;
            border: 1px solid #fc8181;
            border-radius: 6px;
            padding: 15px;
            color: #742a2a;
            margin: 15px 0;
        }
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        .status-connected {
            background: #48bb78;
        }
        .status-disconnected {
            background: #f56565;
        }
        .status-pending {
            background: #ed8936;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .stat-card {
            background: #f7fafc;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        .stat-value {
            font-size: 24px;
            font-weight: 600;
            color: #2d3748;
        }
        .stat-label {
            font-size: 12px;
            color: #4a5568;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        #console-output {
            background: #1a202c;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            height: 200px;
            overflow-y: auto;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 12px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Stellar Ads SDK - Demonstra√ß√£o Completa</h1>
        <p class="subtitle">Sistema de an√∫ncios descentralizados com recompensas Stellar</p>

        <!-- Status da Conex√£o -->
        <div id="connection-status" class="info">
            <strong>üîó Status da Conex√£o:</strong> 
            <span class="status-indicator status-pending"></span>
            <span id="status-text">Verificando conex√£o...</span>
        </div>

        <!-- Controles -->
        <div class="controls">
            <button class="btn" onclick="refreshAds()">üîÑ Atualizar An√∫ncios</button>
            <button class="btn" onclick="toggleDebug()">üêõ Toggle Debug</button>
            <button class="btn" onclick="testWallet()">üëõ Testar Carteira</button>
            <button class="btn" onclick="checkApiHealth()">üè• Status API</button>
            <button class="btn" onclick="simulateClick()">üëÜ Simular Clique</button>
            <button class="btn" onclick="clearConsole()">üßπ Limpar Console</button>
        </div>

        <!-- Estat√≠sticas -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="containers-count">0</div>
                <div class="stat-label">Containers</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="impressions-count">0</div>
                <div class="stat-label">Impress√µes</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="clicks-count">0</div>
                <div class="stat-label">Cliques</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="rewards-earned">0.00</div>
                <div class="stat-label">XLM Ganhos</div>
            </div>
        </div>

        <!-- Console de Debug -->
        <div class="demo-section">
            <div class="demo-title">üîç Console de Debug</div>
            <div id="console-output"></div>
        </div>

        <!-- Exemplo 1: Container M√©dio com Site Demo 1 -->
        <div class="demo-section">
            <div class="demo-title">üì∫ An√∫ncio M√©dio (728x90) - Site Demo 1</div>
            <div class="code-block">&lt;div data-site-id="demo-site-1" data-size="medium"&gt;&lt;/div&gt;</div>
            <div data-site-id="demo-site-1" data-size="medium" id="container-1"></div>
        </div>

        <!-- Exemplo 2: Container com Tags -->
        <div class="demo-section">
            <div class="demo-title">üè∑Ô∏è An√∫ncio com Tags (Tecnologia, Programa√ß√£o) - Site Demo 2</div>
            <div class="code-block">&lt;div data-site-id="demo-site-2" data-tags="tecnologia,programacao" data-size="large"&gt;&lt;/div&gt;</div>
            <div data-site-id="demo-site-2" data-tags="tecnologia,programacao" data-size="large" id="container-2"></div>
        </div>

        <!-- Exemplo 3: Container Pequeno -->
        <div class="demo-section">
            <div class="demo-title">üì± An√∫ncio Pequeno (300x250) - Site Demo 3</div>
            <div class="code-block">&lt;div data-site-id="demo-site-3" data-size="small"&gt;&lt;/div&gt;</div>
            <div data-site-id="demo-site-3" data-size="small" id="container-3"></div>
        </div>

        <!-- Exemplo 4: Container Responsivo -->
        <div class="demo-section">
            <div class="demo-title">üìê An√∫ncio Responsivo - Site Demo 4</div>
            <div class="code-block">&lt;div data-site-id="demo-site-4" data-size="responsive"&gt;&lt;/div&gt;</div>
            <div data-site-id="demo-site-4" data-size="responsive" id="container-4"></div>
        </div>

        <!-- Instru√ß√µes de Implementa√ß√£o -->
        <div class="info">
            <strong>üîß Configura√ß√£o para Seu Site:</strong>
            <div class="code-block">
// 1. Inclua o SDK no seu HTML
&lt;script src="https://api.stellarads.com/sdk.js"&gt;&lt;/script&gt;

// 2. Adicione containers onde quiser an√∫ncios
&lt;div data-site-id="SEU_SITE_ID" data-size="medium"&gt;&lt;/div&gt;

// 3. (Opcional) Configure par√¢metros avan√ßados
&lt;script&gt;
window.StellarAdsConfig = {
    debug: false,
    autoRefresh: true,
    refreshInterval: 5
};
&lt;/script&gt;
            </div>
        </div>
    </div>

    <!-- Configura√ß√£o do SDK -->
    <script>
        let impressions = 0;
        let clicks = 0;
        let rewards = 0;

        window.StellarAdsConfig = {
            debug: true,
            autoRefresh: false,
            refreshInterval: 2
        };

        // Console personalizado
        function logToConsole(message, type = 'info') {
            const console = document.getElementById('console-output');
            const timestamp = new Date().toLocaleTimeString();
            const colorMap = {
                info: '#e2e8f0',
                success: '#48bb78',
                error: '#f56565',
                warning: '#ed8936'
            };
            
            console.innerHTML += `<div style="color: ${colorMap[type]};">[${timestamp}] ${message}</div>`;
            console.scrollTop = console.scrollHeight;
        }

        function updateStats() {
            document.getElementById('containers-count').textContent = 
                window.StellarAdsSDK?.instance?.containers.size || 0;
            document.getElementById('impressions-count').textContent = impressions;
            document.getElementById('clicks-count').textContent = clicks;
            document.getElementById('rewards-earned').textContent = rewards.toFixed(2);
        }

        function refreshAds() {
            if (window.StellarAdsSDK && window.StellarAdsSDK.refresh) {
                window.StellarAdsSDK.refresh();
                logToConsole('üîÑ An√∫ncios atualizados manualmente', 'info');
            }
        }

        function toggleDebug() {
            if (window.StellarAdsSDK && window.StellarAdsSDK.instance) {
                const instance = window.StellarAdsSDK.instance;
                instance.debug = !instance.debug;
                logToConsole(`üêõ Debug mode: ${instance.debug ? 'ON' : 'OFF'}`, 'info');
            }
        }

        function testWallet() {
            if (window.stellar) {
                window.stellar.getPublicKey().then(publicKey => {
                    logToConsole(`üëõ Carteira conectada: ${publicKey}`, 'success');
                }).catch(error => {
                    logToConsole(`‚ùå Erro na carteira: ${error.message}`, 'error');
                });
            } else {
                logToConsole('‚ö†Ô∏è Carteira Stellar n√£o encontrada', 'warning');
            }
        }

        async function checkApiHealth() {
            try {
                const response = await fetch('http://localhost:3000/api/ad?siteId=demo-site-1');
                if (response.ok) {
                    logToConsole('‚úÖ API de an√∫ncios funcionando', 'success');
                    updateConnectionStatus(true);
                } else {
                    logToConsole(`‚ùå API retornou status: ${response.status}`, 'error');
                    updateConnectionStatus(false);
                }
            } catch (error) {
                logToConsole(`‚ùå Erro na API: ${error.message}`, 'error');
                updateConnectionStatus(false);
            }
        }

        function simulateClick() {
            clicks++;
            rewards += 0.001; // Simular recompensa
            updateStats();
            logToConsole('üëÜ Clique simulado registrado', 'info');
        }

        function clearConsole() {
            document.getElementById('console-output').innerHTML = '';
        }

        function updateConnectionStatus(connected) {
            const statusEl = document.getElementById('connection-status');
            const textEl = document.getElementById('status-text');
            const indicator = statusEl.querySelector('.status-indicator');
            
            if (connected) {
                statusEl.className = 'info';
                textEl.textContent = 'Conectado √† API de an√∫ncios';
                indicator.className = 'status-indicator status-connected';
            } else {
                statusEl.className = 'error';
                textEl.textContent = 'Erro de conex√£o com a API';
                indicator.className = 'status-indicator status-disconnected';
            }
        }

        // Simular carteira Stellar conectada
        window.stellar = {
            getPublicKey: () => Promise.resolve('GA7QYNF7SOWQ3GLR2BGMZEHXAVIRZA4KVWLTJJFC7MGXUA74P7UJVSGZ')
        };

        // Interceptar logs do SDK
        const originalConsoleLog = console.log;
        console.log = function(...args) {
            if (args[0] && args[0].includes('[StellarAds SDK]')) {
                logToConsole(args.join(' '), 'info');
            }
            return originalConsoleLog.apply(console, args);
        };

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            logToConsole('üöÄ Demonstra√ß√£o do Stellar Ads SDK iniciada', 'success');
            checkApiHealth();
            
            // Atualizar estat√≠sticas periodicamente
            setInterval(updateStats, 1000);
            
            // Simular impress√µes periodicamente para demonstra√ß√£o
            setInterval(() => {
                impressions++;
                if (Math.random() > 0.7) { // 30% chance de simular recompensa por impress√£o
                    rewards += 0.0005;
                }
            }, 3000);
        });

    </script>

    <!-- SDK -->
    <script src="./sdk.js"></script>
</body>
</html>
